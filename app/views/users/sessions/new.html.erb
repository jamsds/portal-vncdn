<div class="signin__content">
  <div class="container">
    <%= render "users/shared/head" %>
    <div class="wrapper">
      <h3 class="mt-0">Sign in</h3>
      <% if @valid == false %>
        <div class="alert warning mb-0 mt-3"><p>Couldn't find this email in our clients</p></div>
      <% end %>
      
      <%= form_for(resource, as: resource_name, url: session_path(resource_name)) do |f| %>
        <% if cookies["_ssid"].present? && @valid == true && User.find_by(email: cookies["_ssid"]).present? %>
          <div class="signin__content-ssid-valid mt-3">
            <span class="user_ic">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path d="M378.3,1126a13.812,13.812,0,0,1,6.6,0,12.157,12.157,0,0,1,3.3,1.4,2.666,2.666,0,0,1,1.5,2.2v3h-16v-3a2.8,2.8,0,0,1,1.5-2.2A8.716,8.716,0,0,1,378.3,1126Zm7.4,2.3a11.5,11.5,0,0,0-4.1-.8,11.941,11.941,0,0,0-4.1.8c-1.4.5-2,1-2,1.3v1.1h12.2v-1.1C387.7,1129.3,387,1128.8,385.7,1128.3Zm-6.9-10.5a3.867,3.867,0,1,1-1.2,2.8A3.784,3.784,0,0,1,378.8,1117.8Zm4.3,1.3a2.175,2.175,0,1,0,.6,1.5A2.035,2.035,0,0,0,383.1,1119.1Z" transform="translate(-373.7 -1116.6)"/></svg>
            </span>
            <span>Welcome ! <%= User.find_by(email: cookies["_ssid"]).name %></span>
            <%= f.hidden_field :email, value: cookies["_ssid"] %>
          </div>

          <% flash.each do |key, value| %>
            <div class="alert <%= key %> mb-0 mt-3"><p><%= value %></p></div>
          <% end %>
        <% else %>
          <% flash.each do |key, value| %>
            <div class="alert <%= key %> mb-0 mt-3"><p><%= value %></p></div>
          <% end %>
          <div class="form-group mt-3">
            <%= f.label :email %>
            <%= f.email_field :email, :class => 'form-control', value: cookies["_ssid"], autofocus: true, autocomplete: "email" %>
          </div>
        <% end %>

        <% if @confirmed == false && @permit == true %>
          <div class="signin__content-ssid-unconfirmed mt-4">
            <p>Oop! We have sent you email confirm, but look like this email not confirmed. Please confirm and come back again</p>
            <p>Didn't receive confirmation instructions?</p>
            <a href="<%= new_confirmation_path(resource_name) %>" class="btn btn-default primary btn-block mb-3">Send Confirmation Instructions Again</a>
            <div class="signup__refer">
              <div class="signup__refer-heading">
                <p>Sign in with another account</p>
              </div>
              <div class="signup__refer-content">
                <a href="<%= root_url %>" class="btn btn-light btn-block">Customer Sign in</a>
              </div>
            </div>
          </div>
        <% elsif @permit == false %>
          <div class="signin__content-ssid-unconfirmed mt-4">
            <p>We have discovered you in our system. But you did not belong to this reseller. Please check with your reseller and log in again.</p>
            <div class="signup__refer">
              <div class="signup__refer-heading">
                <p>Sign in with another account</p>
              </div>
              <div class="signup__refer-content">
                <a href="<%= root_url %>" class="btn btn-light btn-block">Customer Sign in</a>
              </div>
            </div>
          </div>
        <% end %>

        <% if cookies["_ssid"].present? && @valid == true && @confirmed == true && @permit == true %>
          <div class="form-group mt-3">
            <%= f.label :password %>
            <%= f.password_field :password, :class => 'form-control', autocomplete: "off" %>
            <small><a href="<%= new_password_path(resource_name) %>">Can't you remember the password?</a></small>
          </div>

          <div class="mt-3">
            <%= f.submit "Sign in", :class => 'btn btn-default primary btn-block mb-3' %>
            <div class="signup__refer">
              <div class="signup__refer-heading">
                <p>Sign in with another account</p>
              </div>
              <div class="signup__refer-content">
                <a href="<%= root_url %>" class="btn btn-light btn-block">Customer Sign in</a>
              </div>
            </div>
          </div>
        <% end %>

        <% if cookies["_ssid"].nil? || cookies["_ssid"] == "" %>
          <p class="btn btn-default primary ssid_check btn-block">Customer Sign in</p>
          <div class="signup__refer">
            <div class="signup__refer-heading">
              <p>New to <% if @parent_uuid.present? && @parent_uuid.company.present? %><%= @parent_uuid.company %><% else %>VNCDN<% end %></p>
            </div>

            <div class="signup__refer-content">
              <a href="<%= new_registration_path(resource_name) %>" class="btn btn-light btn-block">Create New Account</a>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>
    <div class="signin__content-footer">
      <p>Â© <%= Date.current.strftime("%Y") %> <% if @parent_uuid.present? && @parent_uuid.company.present? %><%= @parent_uuid.company %><% else %>VNCDN<% end %></span>
    </div>
  </div>
</div>